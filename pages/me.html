<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>Hello MUI</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="../css/mui.min.css">
		<style type="text/css">
			.mui-table-view:first-child {
				margin-top: 15px;
			}
			
			.mui-table-view:last-child {
				margin-bottom: 30px;
			}
			
			.mui-table-view {
				margin-top: 20px;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<h1 id="title" class="mui-title">最近联系</h1>
			<a class="mui-action-menu mui-icon mui-icon-bars mui-pull-right" href="#topPopover" id="menu"></a>
		</header>
		<div class="mui-content">
			<ul class="mui-table-view mui-table-view-chevron">
				<li class="mui-table-view-cell mui-media">
					<a class="mui-navigate-right" href="javascript:;" id="accountPage">
						<img class="mui-media-object mui-pull-left head-img" id="head-img" src="">
						<div class="mui-media-body">
							<span id="userName">
								
							</span>
							<p class='mui-ellipsis'>账号:
								<span id="account">
								
								</span>
							</p>
						</div>
					</a>
				</li>
			</ul>
			<ul class="mui-table-view mui-table-view-chevron">
				<li class="mui-table-view-cell">
					<a href="javascript:;" class="mui-navigate-right" id="accountOther">账号与安全</a>
				</li>
			</ul>
			<ul class="mui-table-view mui-table-view-chevron">
				<li class="mui-table-view-cell">
					<a href="#notifications" class="mui-navigate-right">新消息通知</a>
				</li>
				<li class="mui-table-view-cell">
					<a href="#privacy" class="mui-navigate-right">隐私</a>
				</li>
				<li class="mui-table-view-cell">
					<a href="#general" class="mui-navigate-right">通用</a>
				</li>
			</ul>
			<ul class="mui-table-view mui-table-view-chevron">
				<li class="mui-table-view-cell">
					<a href="#about" class="mui-navigate-right">关于MUI <i class="mui-pull-right update">V3.1.0</i></a>
				</li>
			</ul>
			<ul class="mui-table-view">
				<li class="mui-table-view-cell" style="text-align: center;" id="layout">
					<a>退出登录</a>
				</li>
			</ul>
		</div>

	</body>
	<script src="../js/mui.min.js "></script>
	<script>
		(function($, doc) {
			mui.init();
			mui.plusReady(function() {
				//用户头像
				getHeadImg();

				function getHeadImg() {
					if(JSON.parse(localStorage.getItem('userInfo')).headImgUrl) {
						var headUrl = localStorage.getItem('ip') + JSON.parse(localStorage.getItem('userInfo')).headImgUrl.replace('public', '');
						doc.getElementById('head-img').src = headUrl;

					}
					var userName = JSON.parse(localStorage.getItem('userInfo')).name;
					doc.getElementById('userName').innerText = userName;
					var account = JSON.parse(localStorage.getItem('userInfo')).account;
					doc.getElementById('account').innerText = account;

				}
				window.addEventListener('getHeadImg', function() {
					getHeadImg();
				})
				doc.getElementById('accountPage').addEventListener('tap', function() {
					mui.openWindow({
						url: "./me/account.html",
						id: 'account.html',
						show: {
							aniShow: 'pop-in'
						},
						waiting: {
							autoShow: true
						}
					})
				})
				doc.getElementById('accountOther').addEventListener('tap', function() {
					mui.openWindow({
						url: "./me/account.html",
						id: 'account.html',
						show: {
							aniShow: 'pop-in'
						},
						waiting: {
							autoShow: true
						}
					})
				})
				doc.getElementById('layout').addEventListener('tap', function() {
					//					console.log(plus.navigator.getCookie(localStorage.getItem("ip")))
					// mui.ajax(localStorage.getItem("ip") + '/layout', {
					// 	data: {},
					// 	dataType: 'json', //服务器返回json格式数据
					// 	type: 'get', //HTTP请求类型
					// 	timeout: 10000, //超时时间设置为10秒；
					// 	success: function(data) {
					// 		console.log(data);
					// 	}
					// })					 
					localStorage.removeItem('noChatId');
					plus.runtime.restart();
				})
			})

		}(mui, document));
	</script>

</html>